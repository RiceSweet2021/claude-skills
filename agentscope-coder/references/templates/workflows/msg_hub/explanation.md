# 消息中心教程

## 核心概念

MsgHub（消息中心）是 AgentScope 中实现多 Agent 通信的核心组件。它提供了以下功能：

1. **广播通信**：一个 Agent 同时向多个 Agent 发送消息
2. **点对点通信**：指定发送方和接收方的定向通信
3. **网络管理**：建立和管理 Agent 之间的通信连接
4. **消息路由**：根据连接关系自动路由消息

MsgHub 适合构建多 Agent 协作系统，如团队协作、分布式任务处理等。

---

## 代码解析

### 知识点 1：创建消息中心

**核心代码：**
```python
from agentscope.msghub import MsgHub

hub = MsgHub()
```

**解析：**

MsgHub 是通信的中枢，负责：

1. **连接管理**：记录哪些 Agent 可以互相通信
2. **消息传递**：在 Agent 之间传递消息
3. **路由控制**：根据连接关系决定消息传递路径

### 知识点 2：建立 Agent 连接

**核心代码：**
```python
# sender 可以向 receivers 发送消息
hub.connect(sender, receivers)

# 多个接收者
hub.connect(manager, [worker1, worker2, worker3])

# 双向通信
hub.connect(agent1, agent2)
hub.connect(agent2, agent1)  # 反向连接
```

**解析：**

连接关系的含义：

| 连接方式 | 说明 | 示例场景 |
|---------|------|---------|
| 一对多 | 一个发送者，多个接收者 | 经理 → 员工们 |
| 多对一 | 多个发送者，一个接收者 | 员工们 → 经理 |
| 点对点 | 单个发送者，单个接收者 | 协作者之间 |

### 知识点 3：发送消息

**核心代码：**
```python
# 点对点发送
hub.send(sender, message, receiver)

# 广播发送（向所有连接的接收者）
hub.send(sender, message, broadcast=True)
```

**解析：**

消息发送的方式：

| 方式 | 方法 | 说明 |
|------|------|------|
| 定向发送 | `send(msg, receiver=X)` | 发送给指定的接收者 |
| 广播发送 | `send(msg, broadcast=True)` | 发送给所有连接的 Agent |

---

## 关键知识点总结

| 知识点 | 要点 |
|--------|------|
| MsgHub | 多 Agent 通信的消息中心 |
| connect() | 建立 Agent 之间的连接关系 |
| send() | 发送消息，支持定向和广播 |
| 通信模式 | 支持一对多、多对一、点对点 |

---

## 典型应用场景

| 场景 | 通信模式 |
|------|---------|
| 任务分发 | 经理广播任务给员工 |
| 结果收集 | 员工汇报结果给经理 |
| 协作讨论 | 团队成员之间的点对点讨论 |

---

## 练习题

1. 创建一个三人讨论组，实现两两互通的通信网络
2. 实现一个"消息过滤器"，只转发特定类型的消息
3. 设计一个环形通信网络，消息按顺序传递
